{% extends "pages/hotels/details.html" %}

{% block hotel_menu_content %}
  <h2>
    Hotel Static Content
  </h2>

  <form method="GET" action="{% url 'hotel_staticcontent_list' hotel.id %}">
    <div class="row form-inline">
      <div class="col-md-10">
        <hr>
        <input type="text" class="form-control" autofocus id="search_text" name="search_text">
        <button type="submit" class="btn btn-primary form-control"><i class="fas fa-search"></i> Search</button>
        {% comment %} <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#exampleModal">
                <i class="fas fa-file-import"></i> Import
            </button>  {% endcomment %}

        <a class="btn btn-primary float-right" data-toggle="modal" data-target="#add" href="#add"><i
                class="fas fa-plus"></i> Add</a>
        <hr>
      </div>
    </div>
  </form>
  <script>
    var urlParams = new URLSearchParams(window.location.search);
    document.getElementById('search_text').value = urlParams.get('search_text');
  </script>

  <div class="row">
    <div class="col-md-10">
      <table class="table table-sm table-striped">
        <thead class="thead-dark">
        <th>Room Type</th>
        <th>Content Upload Type</th>
        <th>Upload Type</th>
        <th>Added On</th>
        <th>Action</th>
        </thead>
        <tbody>
        {% for item in static_contents %}
          <tr>
            <td>{{ item.room_type }}</td>
            <td>{{ item.file_type }}</td>
            <td>{{ item.content.name }}</td>
            <td>{{ item.added_on }}</td>
            <td style="white-space:nowrap;" >
              <a class="btn btn-primary" href="{% url 'hotel_staticcontent_edit' hotel.id item.id %}"> Edit</a>
              <a class="btn btn-primary" href="{% url 'hotel_staticcontent_delete' hotel.id item.id %}"> Delete</a>
            </td>
          </tr>
        {% endfor %}
        </tbody>
      </table>

      {% if static_contents.has_other_pages %}
        <nav aria-label="Page navigation example">
          <ul class="pagination">
            {% if static_contents.has_previous %}
              <li class="page-item"><a class="page-link" href="?page=1">First</a></li>
              <li class="page-item"><a class="page-link" href="?page={{ static_contents.previous_page_number }}">Previous</a>
              </li>
            {% endif %}
            <li class="page-item"><a class="page-link" href="#">
              Page {{ static_contents.number }} of {{ static_contents.paginator.num_pages }}.
            </a></li>
            {% if static_contents.has_next %}
              <li class="page-item"><a class="page-link" href="?page={{ static_contents.next_page_number }}">Next</a>
              </li>
              <li class="page-item"><a class="page-link" href="?page={{ static_contents.paginator.num_pages }}">Last</a>
              </li>
            {% endif %}

          </ul>
        </nav>
      {% endif %}
    </div>
  </div>

{% endblock hotel_menu_content %}





{% block modal %}

  <div class="modal fade" id="add" tabindex="-1" role="dialog" aria-labelledby="addHotelImageLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg" role="document">
      <div class="modal-content">
        <form method="POST" enctype="multipart/form-data" action="{% url 'hotel_staticcontent_add' hotel.id %}">
          {% csrf_token %}

          <div class="modal-header">
            <h5 class="modal-title" id="addHotelImage">
              Add static content
            </h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">
            {{ form.as_p }}
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
            <button type="submit" class="btn btn-primary" title="Your custom upload logic">Submit</button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <script>
    $(document).ready(function () {
      $("#exampleModal").fileinput({
        showPreview: false,
        showUpload: false,
        elErrorContainer: '#kartik-file-errors',
        allowedFileExtensions: ["json"]
        //uploadUrl: '/site/file-upload-single'
      });
    });
    {% if  is_form_failed %}
      $(window).on('load', function () {
        $('#add').modal('show');
      });

    {% endif %}

  </script>

{% endblock modal %}
